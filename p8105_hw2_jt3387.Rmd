---
title: "p8105_hw2_jt3387"
output: github_document
---
  
```{r, message = FALSE}
library(tidyverse)
library(readxl)
```

## Problem 1

Read and clean the New York transit subway data.

```{r}
nyc_transit <- read_csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
                        col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>% 
  janitor::clean_names() %>% 
  select(line:ada, -c(exit_only, staffing, staff_hours)) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
```

A brief description of the data:
  
- The resulting dataset contains ``r nrow(nyc_transit)`` rows and ``r ncol(nyc_transit)`` columns. The dataset contains the following variables: *line*, *station_name*, *station_latitude*, *station_longitude*, *route1* to *route11*, *entrance_type*, *entry*, *vending*, and *ada*. 

- The data cleaning steps: I firstly read the dataset using `read_csv`, and clean the names with `clean_name` function. Then I use `select` to choose the variables I need, after that I convert the entry variable from character (YES and NO) to a logical variable(TRUE and FALSE) using `recode`.

- I think these datas are not tidy, as the route information can still be integrated and simplified and other variables like `entry` and `vending` with values of Yes and No can also be converted to logical variables.

Quantitative analysis of the variables.

```{r}
dis_station <- nyc_transit %>% 
  distinct(station_name, line)
nrow(dis_station)
```

- There are 465 distinct stations.

```{r}
dis_station_ada <- nyc_transit %>%
  filter(ada == TRUE) %>% 
  distinct(station_name, line)
nrow(dis_station_ada)
```

- 84 stations are ADA compliant.

```{r}
nyc_transit_entry = nyc_transit %>% 
  filter(vending == "NO") %>% 
  pull(entry)
mean(nyc_transit_entry)
```

- Around 37.7% of station entrances/exits without vending allow entrance.

Reformat data so that route number and route name are distinct variables.

```{r}
nyc_transit_A <- nyc_transit %>% 
  pivot_longer(
    cols = route1:route11, 
    names_to = "route_number",
    names_prefix = "route",
    values_to = "route_name",
    values_drop_na = T) %>% 
  filter(route_name == "A") %>% 
  distinct(station_name, line, .keep_all = TRUE)
nrow(nyc_transit_A)
```

- 60 distinct stations serve the A train.

```{r}
nyc_transit_A_ada <- nyc_transit_A %>% 
  filter(ada == TRUE)
nrow(nyc_transit_A_ada)
```

- Of the stations that serve the A train, 17 stations are ADA compliant.

## Problem 2

Read and clean the Mr. Trash Wheel sheet and Professor Trash Wheel data.

```{r}
mr_trash <- read_excel("data/Trash Wheel Collection Data.xlsx", 
                       sheet ="Mr. Trash Wheel", range = "A2:N550") %>%
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = as.integer(round(sports_balls, digits = 0)),
         year = as.numeric(year)) 
prof_trash <- read_excel("data/Trash Wheel Collection Data.xlsx", 
                         sheet ="Professor Trash Wheel", range = "A2:M97") %>%
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(year = as.numeric(year)) 
```

Add an additional variable `trash_wheel_type` to both data set and combine them.

```{r, message = FALSE}
mr_trash = mr_trash %>% mutate(trash_wheel_type = "Mr Trash Wheel")
prof_trash = prof_trash %>% mutate(trash_wheel_type = "Professor Trash Wheel")
merge_trash = full_join(mr_trash, prof_trash)
```

A brief description of the data:
  
- There are `r ncol(merge_trash)` variables and `r nrow(merge_trash)` observations.

- Some examples of key variables: `dumpster` shows the ID of the trash; `month`, `year`, `date` variables represent the time when the trash was collected. `weight_tons` and `volume_cubic_yards` represent the mass and volume of the trash; `plastic_bottle`, `polystyrene`, `cigarette_butt`, `glass_bottle`, `grocery_bag`, `chip_bag` and `sport_ball` shows the amount of different kinds of trash in every dumpster. `homes_poewred` represents how many homes the dumpster powered; and `trash_wheel_type` indicates whether it's collected by Mr. Trash Wheel or Professor Trash Wheel.

